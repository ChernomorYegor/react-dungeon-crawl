(this["webpackJsonpreact-dungeon-crawl"]=this["webpackJsonpreact-dungeon-crawl"]||[]).push([[0],{18:function(e,t,a){e.exports=a(29)},23:function(e,t,a){},29:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(10),i=a.n(l),o=(a(23),a(3)),c=a(31),s={"GAME/START_GAME":Object(c.a)("GAME/START_GAME"),"SETTINGS/SHOW_SETTINGS":Object(c.a)("SETTINGS/SHOW_SETTINGS")},m={DIFFICULTY:{easy:20,medium:25,hard:30},CERTIFICATES:25,SKILLS:3,BOSSES:1};var u=function(e){var t=e.showSettings,a=e.startGame,n=e.certificates,l=e.bosses,i=e.difficulty,o=e.mapWidth,c=e.mapHeight,s=e.generateItems,m=e.getRandomNumber;return r.a.createElement("div",{className:"start-container"},r.a.createElement("h1",null,"Dungeon Crawl"),r.a.createElement("div",{className:"start-menu"},r.a.createElement("button",{type:"button",onClick:function(){var e=m(0,o-1),t=function(e){var t=[],a=Math.ceil(o*i/100);console.log(a);for(var r=0;r<c;r++){var u=[];0===r&&(u[e]="player");for(var E=0;E<a;){var p=m(0,o-1);"wall"!==u[p]&&"player"!==u[p]&&(u[p]="wall",E++)}for(var f=0;f<o;f++)u[f]||(u[f]="empty");t.push(u)}return function(e,t){var a=Math.floor(c/t),n=0;console.log(a);for(;n<c;){var r=m(n,n+a-5),l=m(0,o-5);console.log(n);for(var i=1;i<4;i++)e[r][l]="boss-wall",e[r+i][l]="boss-wall",e[r][l+i]="boss-wall",e[r+i][l+3]="boss-wall",e[r+3][l+i]="boss-wall";for(var s=1;s<3;s++)e[r+1][l+s]="boss",e[r+2][l+s]="boss";n+=a}}(t,l),s(t,n,"certificate"),t}(e);console.log(t,e),a({map:t,playerX:e})}},"Start Game"),r.a.createElement("button",{type:"button",onClick:t},"Settings")))},E=Object(o.b)((function(e){return{certificates:m.CERTIFICATES,bosses:m.BOSSES,difficulty:e.settings.difficulty,mapWidth:e.settings.mapWidth,mapHeight:e.settings.mapHeight}}),(function(e){return{startGame:function(t){var a=t.map,n=t.playerX;return e(s["GAME/START_GAME"]({map:a,playerX:n}))},showSettings:function(){return e(s["SETTINGS/SHOW_SETTINGS"]())}}}))(u),p={"GAME/MOVE_LEFT":Object(c.a)("GAME/MOVE_LEFT"),"GAME/MOVE_UP":Object(c.a)("GAME/MOVE_UP"),"GAME/MOVE_RIGHT":Object(c.a)("GAME/MOVE_RIGHT"),"GAME/MOVE_DOWN":Object(c.a)("GAME/MOVE_DOWN"),"GAME/CHANGE_OFFSET":Object(c.a)("GAME/CHANGE_OFFSET"),"GAME/ADD_CERTIFICATE":Object(c.a)("GAME/ADD_CERTIFICATE"),"GAME/START_LEVEL2":Object(c.a)("GAME/START_LEVEL2"),"GAME/ADD_SKILL":Object(c.a)("GAME/ADD_SKILL"),"GAME/REMOVE_BOSS_WALLS":Object(c.a)("GAME/REMOVE_BOSS_WALLS"),"GAME/ADD_POINTS_BOSS":Object(c.a)("GAME/ADD_POINTS_BOSS"),"GAME/QUIT_GAME":Object(c.a)("GAME/QUIT_GAME"),"GAME/END_GAME":Object(c.a)("GAME/END_GAME")},f=a(8);var g=function(e){var t=e.certificatesAll,a=e.skillsAll,l=e.gameMap,i=e.currentCertificates,o=e.currentSkills,c=e.isDefeatedBoss,s=e.level,m=e.points,u=e.currentOffset,E=e.playerX,p=e.playerY,g=e.difficulty,d=e.mapWidth,S=e.mapHeight,b=e.viewportHeight,h=e.moveLeft,O=e.moveUp,v=e.moveRight,A=e.moveDown,y=e.changeOffset,G=e.addCertificate,M=e.startLevel2,T=e.addSkill,w=e.removeBossWalls,I=e.addPointsBoss,_=e.quitGame,j=e.endGame,N=e.generateItems,H=Object(n.useState)(""),D=Object(f.a)(H,2),k=D[0],L=D[1];function C(e,t,a){if(e>0){L(t);var n=setTimeout((function(){L("")}),a);return function(){return clearTimeout(n)}}}function W(e){if("certificate"===e){if(i===t-1){var n=l.slice();console.log("map",n),N(n,a,"skill"),console.log("map",n),M({map:n})}G(Math.round(g*S/100*b/10))}if("skill"===e){if(o===a-1){var r=l.slice();console.log("map",r),r.forEach((function(e,t){return e.forEach((function(e,a){"boss-wall"===e&&(console.log("square-change",e),r[t][a]="empty")}))})),console.log("map",r),w({map:r})}T(Math.round(10*g*S/100*b/10))}"boss"===e&&(I(Math.round(30*g*S/100*b/10)),j())}function V(){window.confirm("Are you sure you want to quit?")&&_()}return Object(n.useEffect)((function(){if(!c){var e=function(e){switch(e.key){case"ArrowLeft":if(console.log("ArrowLeft"),0===E&&"wall"!==l[p][d-1]&&"boss-wall"!==l[p][d-1]){W(l[p][d-1]),h(d-1);break}if(0!==E&&"wall"!==l[p][E-1]&&"boss-wall"!==l[p][E-1]){W(l[p][E-1]),h(E-1);break}break;case"ArrowUp":if(console.log("ArrowUp"),0===p)break;if("wall"!==l[p-1][E]&&"boss-wall"!==l[p-1][E]){p<=3+u&&!(p<=3)&&y(u-1),W(l[p-1][E]),O(p-1);break}break;case"ArrowRight":if(console.log("ArrowRight"),E===d-1&&"wall"!==l[p][0]&&"boss-wall"!==l[p][0]){W(l[p][0]),h(0);break}if(E!==d-1&&"wall"!==l[p][E+1]&&"boss-wall"!==l[p][E+1]){W(l[p][E+1]),v(E+1);break}break;case"ArrowDown":if(console.log("ArrowDown"),p===l.length-1)break;if("wall"!==l[p+1][E]&&"boss-wall"!==l[p+1][E]){p>=b-1-3+u&&!(p>=S-1-3)&&y(u+1),W(l[p+1][E]),A(p+1);break}break;case"Escape":console.log("Quit Game"),V()}};return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}}}),[E,p]),Object(n.useEffect)((function(){C(i,"+1 certificate",500)}),[i]),Object(n.useEffect)((function(){C(o,"+1 skill",500)}),[o]),r.a.createElement("div",{className:"game"},r.a.createElement("div",{className:"top-bar-head"},r.a.createElement("h2",null,"Dungeon Crawl"),r.a.createElement("button",{className:"btn-quit",type:"text",onClick:V},"Quit Game")),r.a.createElement("div",{className:"top-bar"},r.a.createElement("div",{className:"top-bar-stats"},r.a.createElement("div",null,"Level: ",r.a.createElement("span",null,s)),r.a.createElement("div",null,r.a.createElement("p",null,"Certificates: ",r.a.createElement("span",null,i,"/",t)),r.a.createElement("progress",{value:i,max:t})),r.a.createElement("div",null,r.a.createElement("p",null,"Skills: ",r.a.createElement("span",null,o,"/",a)),r.a.createElement("progress",{value:o,max:a})),r.a.createElement("div",null,"Points: ",r.a.createElement("span",null,m))),r.a.createElement("div",{className:"messages"},r.a.createElement("p",null,k),1===s&&r.a.createElement("p",null,"Collect 25 certificates."),2===s&&o<a&&r.a.createElement("p",null,"Collect 3 skills."),2===s&&o===a&&!c&&r.a.createElement("p",null,"Find the boss."))),r.a.createElement("div",{className:"map"},c?r.a.createElement("div",{className:"game-over"},r.a.createElement("p",null,"Congratulations!"),r.a.createElement("p",null,"You left the dungeon!"),r.a.createElement("p",{className:"result"},"Your result: ",m," points.")):function(){for(var e=[],t=u;t<u+b;t++){var a=l[t];e.push(a)}console.log(e),console.log(u);var n=document.documentElement.clientHeight,i=Math.floor(51*n/(100*b));return console.log("squareSize",i),e.map((function(e,t){return r.a.createElement("div",{className:t+u===0?"row-map first":t+u===S-1?"row-map last":"row-map",key:t+u},e.map((function(e,a){return r.a.createElement("div",{className:"square ".concat(e),key:"".concat(t+u).concat(a),style:{width:"".concat(i,"px"),height:"".concat(i,"px")}})})))}))}()),r.a.createElement("div",{className:"bottom-bar"},r.a.createElement("div",null,r.a.createElement("p",null,"Press 'Arrows' on the keyboard to move."),r.a.createElement("p",null,"Press 'Esc' to quit the game or click the button at the top right."))))},d=Object(o.b)((function(e){return{certificatesAll:m.CERTIFICATES,skillsAll:m.SKILLS,gameMap:e.game.map,currentCertificates:e.game.certificates,currentSkills:e.game.skills,isDefeatedBoss:e.game.isDefeatedBoss,level:e.game.level,points:e.game.points,currentOffset:e.game.currentOffset,playerX:e.game.playerX,playerY:e.game.playerY,difficulty:e.settings.difficulty,mapWidth:e.settings.mapWidth,mapHeight:e.settings.mapHeight,viewportHeight:e.settings.viewportHeight}}),(function(e){return{moveLeft:function(t){return e(p["GAME/MOVE_LEFT"](t))},moveUp:function(t){return e(p["GAME/MOVE_UP"](t))},moveRight:function(t){return e(p["GAME/MOVE_RIGHT"](t))},moveDown:function(t){return e(p["GAME/MOVE_DOWN"](t))},changeOffset:function(t){return e(p["GAME/CHANGE_OFFSET"](t))},addCertificate:function(t){return e(p["GAME/ADD_CERTIFICATE"](t))},startLevel2:function(t){var a=t.map;return e(p["GAME/START_LEVEL2"]({map:a}))},addSkill:function(t){return e(p["GAME/ADD_SKILL"](t))},removeBossWalls:function(t){var a=t.map;return e(p["GAME/REMOVE_BOSS_WALLS"]({map:a}))},addPointsBoss:function(t){return e(p["GAME/ADD_POINTS_BOSS"](t))},quitGame:function(){return e(p["GAME/QUIT_GAME"]())},endGame:function(){return e(p["GAME/END_GAME"]())}}}))(g),S={"SETTINGS/HIDE_SETTINGS":Object(c.a)("SETTINGS/HIDE_SETTINGS"),"SETTINGS/SAVE_SETTINGS":Object(c.a)("SETTINGS/SAVE_SETTINGS")};var b=function(e){var t=e.difficultyOptions,a=e.difficulty,l=(e.mapWidth,e.mapHeight),i=(e.viewportWidth,e.viewportHeight),o=e.backToStartMenu,c=e.saveSettings,s=Object(n.useState)(a),m=Object(f.a)(s,2),u=m[0],E=m[1],p=Object(n.useState)(l),g=Object(f.a)(p,2),d=g[0],S=g[1],b=Object(n.useState)(i),h=Object(f.a)(b,2),O=h[0],v=h[1];function A(e,t){switch(e){case"Difficulty":E(+t.target.value);break;case"Map Height":S(+t.target.value);break;case"Viewport Height":v(+t.target.value)}}return r.a.createElement("div",{className:"settings"},r.a.createElement("div",{className:"top-bar-head"},r.a.createElement("h3",null,"Settings"),r.a.createElement("button",{className:"btn-back",type:"text",onClick:o},"Back")),r.a.createElement("form",{className:"settings-form",onSubmit:function(e){e.preventDefault(),console.log({difficultyInner:u,mapHeightInner:d,viewportHeightInner:O}),c({difficultyInner:u,mapHeightInner:d,viewportHeightInner:O})}},r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"difficulty"},"Difficulty:"),r.a.createElement("select",{id:"difficulty",value:u,onChange:A.bind(this,"Difficulty")},r.a.createElement("option",{value:t.easy},"Easy"),r.a.createElement("option",{value:t.medium},"Medium"),r.a.createElement("option",{value:t.hard},"Hard"))),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"map-height"},"Map Height ",r.a.createElement("small",null,"(50 - 500)"),":"),r.a.createElement("input",{id:"map-height",type:"number",value:d,min:"50",max:"500",step:"5",onChange:A.bind(this,"Map Height")})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"viewport-height"},"Viewport Height ",r.a.createElement("small",null,"(10 - 20)"),":"),r.a.createElement("input",{id:"viewport-height",type:"number",value:O,min:"10",max:"20",step:"1",onChange:A.bind(this,"Viewport Height")})),r.a.createElement("button",{type:"submit",className:"btn-save"},"Save")))},h=Object(o.b)((function(e){return{difficultyOptions:m.DIFFICULTY,difficulty:e.settings.difficulty,mapWidth:e.settings.mapWidth,mapHeight:e.settings.mapHeight,viewportWidth:e.settings.viewportWidth,viewportHeight:e.settings.viewportHeight}}),(function(e){return{backToStartMenu:function(){return e(S["SETTINGS/HIDE_SETTINGS"]())},saveSettings:function(t){var a=t.difficultyInner,n=t.mapHeightInner,r=t.viewportHeightInner;return e(S["SETTINGS/SAVE_SETTINGS"]({difficultyInner:a,mapHeightInner:n,viewportHeightInner:r}))}}}))(b);var O=function(e){var t=e.isSettingsShow,a=e.gameOn,n=e.mapWidth,l=e.mapHeight,i=document.documentElement.clientHeight;function o(e,t,a){var r=Math.floor(l/t),i=0,o=0;for(l%t!==0&&(i=1,o=Math.ceil(l%t)-1),console.log("itemBalance",o),console.log("itemsInterval",r);i<l;){var s=c(i,i+r-1),m=c(0,n-1);console.log("itemVar",i),"empty"!==e[s][m]||0!==m&&m!==n-1&&0!==s&&s!==l-1&&"wall"===e[s][m-1]&&"boss-wall"===e[s][m-1]&&"wall"===e[s+1][m]&&"boss-wall"===e[s+1][m]&&"wall"===e[s][m+1]&&"boss-wall"===e[s][m+1]&&"wall"===e[s-1][m]&&"boss-wall"===e[s-1][m]||(e[s][m]=a,o>0?(i+=r+1,o--):0===o&&(i+=r))}}function c(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}return r.a.createElement("div",{style:{height:i+"px"}},!t&&!a&&r.a.createElement(E,{generateItems:o,getRandomNumber:c}),a&&r.a.createElement(d,{generateItems:o,getRandomNumber:c}),t&&r.a.createElement(h,null))},v=Object(o.b)((function(e){return{isSettingsShow:e.settings.isSettingsShow,gameOn:e.game.gameOn,mapWidth:e.settings.mapWidth,mapHeight:e.settings.mapHeight}}),(function(e){return{}}))(O);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var A,y,G=a(5),M=a(1),T=a(2),w=a.n(T),I=a(30),_=Object(I.a)((A={},Object(M.a)(A,s["SETTINGS/SHOW_SETTINGS"],(function(e,t){return w()(e,{$merge:{isSettingsShow:!0}})})),Object(M.a)(A,S["SETTINGS/HIDE_SETTINGS"],(function(e,t){return w()(e,{$merge:{isSettingsShow:!1}})})),Object(M.a)(A,S["SETTINGS/SAVE_SETTINGS"],(function(e,t){return w()(e,{$merge:{difficulty:t.payload.difficultyInner,mapHeight:t.payload.mapHeightInner,viewportHeight:t.payload.viewportHeightInner}})})),A),{isSettingsShow:!1,difficulty:20,mapWidth:20,mapHeight:100,viewportWidth:20,viewportHeight:10}),j={gameOn:!1,map:[],certificates:0,skills:0,isDefeatedBoss:!1,level:0,points:0,currentOffset:0,playerX:0,playerY:0},N=Object(I.a)((y={},Object(M.a)(y,s["GAME/START_GAME"],(function(e,t){return console.log(t.payload),w()(e,{$merge:{gameOn:!0,map:t.payload.map,level:1,playerX:t.payload.playerX}})})),Object(M.a)(y,p["GAME/MOVE_LEFT"],(function(e,t){var a;return w()(e,{map:Object(M.a)({},e.playerY,(a={},Object(M.a)(a,e.playerX,{$set:"empty"}),Object(M.a)(a,t.payload,{$set:"player"}),a)),playerX:{$set:t.payload}})})),Object(M.a)(y,p["GAME/MOVE_UP"],(function(e,t){var a;return w()(e,{map:(a={},Object(M.a)(a,e.playerY,Object(M.a)({},e.playerX,{$set:"empty"})),Object(M.a)(a,t.payload,Object(M.a)({},e.playerX,{$set:"player"})),a),playerY:{$set:t.payload}})})),Object(M.a)(y,p["GAME/MOVE_RIGHT"],(function(e,t){var a;return w()(e,{map:Object(M.a)({},e.playerY,(a={},Object(M.a)(a,e.playerX,{$set:"empty"}),Object(M.a)(a,t.payload,{$set:"player"}),a)),playerX:{$set:t.payload}})})),Object(M.a)(y,p["GAME/MOVE_DOWN"],(function(e,t){var a;return w()(e,{map:(a={},Object(M.a)(a,e.playerY,Object(M.a)({},e.playerX,{$set:"empty"})),Object(M.a)(a,t.payload,Object(M.a)({},e.playerX,{$set:"player"})),a),playerY:{$set:t.payload}})})),Object(M.a)(y,p["GAME/CHANGE_OFFSET"],(function(e,t){return w()(e,{$merge:{currentOffset:t.payload}})})),Object(M.a)(y,p["GAME/ADD_CERTIFICATE"],(function(e,t){return w()(e,{$merge:{certificates:e.certificates+1,points:e.points+t.payload}})})),Object(M.a)(y,p["GAME/START_LEVEL2"],(function(e,t){return w()(e,{$merge:{map:t.payload.map,level:2}})})),Object(M.a)(y,p["GAME/ADD_SKILL"],(function(e,t){return w()(e,{$merge:{skills:e.skills+1,points:e.points+t.payload}})})),Object(M.a)(y,p["GAME/REMOVE_BOSS_WALLS"],(function(e,t){return w()(e,{$merge:{map:t.payload.map}})})),Object(M.a)(y,p["GAME/ADD_POINTS_BOSS"],(function(e,t){return w()(e,{$merge:{points:e.points+t.payload}})})),Object(M.a)(y,p["GAME/QUIT_GAME"],(function(e,t){return w()(e,{$merge:{gameOn:j.gameOn,map:j.map,certificates:j.certificates,skills:j.skills,isDefeatedBoss:j.isDefeatedBoss,level:j.level,points:j.points,currentOffset:j.currentOffset,playerX:j.playerX,playerY:j.playerY}})})),Object(M.a)(y,p["GAME/END_GAME"],(function(e,t){return w()(e,{$merge:{isDefeatedBoss:!0}})})),y),j),H=Object(G.c)({settings:_,game:N}),D=a(17),k=a.n(D),L=Object(G.d)(H,Object(G.a)(k.a));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(o.a,{store:L},r.a.createElement(v,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[18,1,2]]]);
//# sourceMappingURL=main.7c0ea5f1.chunk.js.map