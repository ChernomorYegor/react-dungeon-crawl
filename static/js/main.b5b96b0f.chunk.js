(this["webpackJsonpreact-dungeon-crawl"]=this["webpackJsonpreact-dungeon-crawl"]||[]).push([[0],{18:function(e,t,a){e.exports=a(29)},23:function(e,t,a){},29:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(9),l=a.n(i),o=(a(23),a(4)),c=a(3),s=a(31),u={"GAME/START_GAME":Object(s.a)("GAME/START_GAME"),"GAME/MOVE_LEFT":Object(s.a)("GAME/MOVE_LEFT"),"GAME/MOVE_UP":Object(s.a)("GAME/MOVE_UP"),"GAME/MOVE_RIGHT":Object(s.a)("GAME/MOVE_RIGHT"),"GAME/MOVE_DOWN":Object(s.a)("GAME/MOVE_DOWN"),"GAME/CHANGE_OFFSET_X":Object(s.a)("GAME/CHANGE_OFFSET_X"),"GAME/CHANGE_OFFSET_Y":Object(s.a)("GAME/CHANGE_OFFSET_Y"),"GAME/ADD_CERTIFICATE":Object(s.a)("GAME/ADD_CERTIFICATE"),"GAME/START_LEVEL2":Object(s.a)("GAME/START_LEVEL2"),"GAME/ADD_SKILL":Object(s.a)("GAME/ADD_SKILL"),"GAME/REMOVE_BOSS_WALLS":Object(s.a)("GAME/REMOVE_BOSS_WALLS"),"GAME/ADD_POINTS_BOSS":Object(s.a)("GAME/ADD_POINTS_BOSS"),"GAME/QUIT_GAME":Object(s.a)("GAME/QUIT_GAME"),"GAME/END_GAME":Object(s.a)("GAME/END_GAME")},m={"SETTINGS/SHOW_SETTINGS":Object(s.a)("SETTINGS/SHOW_SETTINGS"),"SETTINGS/HIDE_SETTINGS":Object(s.a)("SETTINGS/HIDE_SETTINGS"),"SETTINGS/SAVE_SETTINGS":Object(s.a)("SETTINGS/SAVE_SETTINGS")},E={DIFFICULTY:{easy:20,medium:25,hard:30},CERTIFICATES:25,SKILLS:3,BOSSES:1};var p=function(e){var t=e.CERTIFICATES,a=e.BOSSES,n=e.difficulty,i=e.mapWidth,l=e.mapHeight,o=e.viewportWidth,c=e.generateItems,s=e.getRandomNumber,u=e.startGame,m=e.showSettings;return r.a.createElement("div",{className:"start-container"},r.a.createElement("h1",null,"Dungeon Crawl"),r.a.createElement("div",{className:"start-menu"},r.a.createElement("button",{type:"button",onClick:function(){var e=s(0,o-1),r=function(e){var r=[],o=Math.ceil(i*n/100);console.log(o);for(var u=0;u<l;u++){var m=[];0===u&&(m[e]="player");for(var E=0;E<o;){var p=s(0,i-1);"wall"===m[p]||"player"===m[p]||1===u&&p===e||(m[p]="wall",E++)}for(var f=0;f<i;f++)m[f]||(m[f]="empty");r.push(m)}return function(e,t){var a=Math.floor(l/t),n=0;console.log(a);for(;n<l-1;){var r=s(n+1,n+a-5),o=s(0,i-5);console.log(n);for(var c=1;c<4;c++)e[r][o]="boss-wall",e[r+c][o]="boss-wall",e[r][o+c]="boss-wall",e[r+c][o+3]="boss-wall",e[r+3][o+c]="boss-wall";for(var u=1;u<3;u++)e[r+1][o+u]="boss",e[r+2][o+u]="boss";n+=a}}(r,a),c(r,t,"certificate"),r}(e);console.log(r,e),u({map:r,playerX:e})}},"Start Game"),r.a.createElement("button",{type:"button",onClick:m},"Settings")))},f=Object(o.b)((function(e){return{CERTIFICATES:E.CERTIFICATES,BOSSES:E.BOSSES,difficulty:e.settings.difficulty,mapWidth:e.settings.mapWidth,mapHeight:e.settings.mapHeight,viewportWidth:e.settings.viewportWidth}}),(function(e){return{startGame:function(t){var a=t.map,n=t.playerX;return e(u["GAME/START_GAME"]({map:a,playerX:n}))},showSettings:function(){return e(m["SETTINGS/SHOW_SETTINGS"]())}}}))(p);var d=function(e){var t=e.CERTIFICATES,a=e.SKILLS,i=e.gameMap,l=e.currentCertificates,o=e.currentSkills,s=e.isDefeatedBoss,u=e.level,m=e.points,E=e.currentOffsetX,p=e.currentOffsetY,f=e.playerX,d=e.playerY,h=e.difficulty,g=e.mapWidth,S=e.mapHeight,O=e.viewportWidth,b=e.viewportHeight,v=e.moveLeft,w=e.moveUp,A=e.moveRight,M=e.moveDown,T=e.changeOffsetX,y=e.changeOffsetY,G=e.addCertificate,I=e.startLevel2,j=e.addSkill,_=e.removeBossWalls,N=e.addPointsBoss,H=e.quitGame,W=e.endGame,D=e.windowWidth,C=e.windowHeight,k=e.generateItems,L=Object(n.useState)(""),F=Object(c.a)(L,2),V=F[0],R=F[1],X=Object(n.useState)(0),Y=Object(c.a)(X,2),B=Y[0],$=Y[1];function x(e,t,a){if(e>0){R(t);var n=setTimeout((function(){R("")}),a);return function(){return clearTimeout(n)}}}function U(e){if("certificate"===e){if(l===t-1){var n=i.slice();console.log("map",n),k(n,a,"skill"),console.log("map",n),I({map:n})}G(Math.round(P(10)))}if("skill"===e){if(o===a-1){var r=i.slice();console.log("map",r),r.forEach((function(e,t){return e.forEach((function(e,a){"boss-wall"===e&&(console.log("square-change",e),r[t][a]="empty")}))})),console.log("map",r),_({map:r})}j(Math.round(P(100)))}"boss"===e&&(N(Math.round(P(300))),W())}function P(e){return e*h*(g/100)*(S/100)*(10/O)*(10/b)}function K(){window.confirm("Are you sure you want to quit?")&&H()}return Object(n.useEffect)((function(){var e=Math.floor(91*D/(100*O)),t=Math.floor(51*C/(100*b));$(e<t?e:t)}),[]),Object(n.useEffect)((function(){if(!s){var e=function(e){switch(e.key){case"ArrowLeft":if(console.log("ArrowLeft"),0===f&&"wall"!==i[d][g-1]&&"boss-wall"!==i[d][g-1]){T(g-1-(O-1)),U(i[d][g-1]),v(g-1);break}if(0!==f&&"wall"!==i[d][f-1]&&"boss-wall"!==i[d][f-1]){f<=3+E&&!(f<=3)&&T(E-1),U(i[d][f-1]),v(f-1);break}break;case"ArrowUp":if(console.log("ArrowUp"),0===d)break;if("wall"!==i[d-1][f]&&"boss-wall"!==i[d-1][f]){d<=3+p&&!(d<=3)&&y(p-1),U(i[d-1][f]),w(d-1);break}break;case"ArrowRight":if(console.log("ArrowRight"),f===g-1&&"wall"!==i[d][0]&&"boss-wall"!==i[d][0]){T(0),U(i[d][0]),v(0);break}if(f!==g-1&&"wall"!==i[d][f+1]&&"boss-wall"!==i[d][f+1]){f>=O-1-3+E&&!(f>=g-1-3)&&T(E+1),U(i[d][f+1]),A(f+1);break}break;case"ArrowDown":if(console.log("ArrowDown"),d===i.length-1)break;if("wall"!==i[d+1][f]&&"boss-wall"!==i[d+1][f]){d>=b-1-3+p&&!(d>=S-1-3)&&y(p+1),U(i[d+1][f]),M(d+1);break}break;case"Escape":console.log("Quit Game"),K()}};return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}}}),[f,d]),Object(n.useEffect)((function(){x(l,"+1 certificate",500)}),[l]),Object(n.useEffect)((function(){x(o,"+1 skill",500)}),[o]),r.a.createElement("div",{className:"game"},r.a.createElement("div",{className:"top-bar-head"},r.a.createElement("h2",null,"Dungeon Crawl"),r.a.createElement("button",{className:"btn-quit",type:"text",onClick:K},"Quit Game")),r.a.createElement("div",{className:"top-bar"},r.a.createElement("div",{className:"top-bar-stats"},r.a.createElement("div",null,"Level: ",r.a.createElement("span",null,u)),r.a.createElement("div",null,r.a.createElement("p",null,"Certificates: ",r.a.createElement("span",null,l,"/",t)),r.a.createElement("progress",{value:l,max:t})),r.a.createElement("div",null,r.a.createElement("p",null,"Skills: ",r.a.createElement("span",null,o,"/",a)),r.a.createElement("progress",{value:o,max:a})),r.a.createElement("div",null,"Points: ",r.a.createElement("span",null,m))),r.a.createElement("div",{className:"messages"},r.a.createElement("p",null,V),1===u&&r.a.createElement("p",null,"Collect 25 certificates."),2===u&&o<a&&r.a.createElement("p",null,"Collect 3 skills."),2===u&&o===a&&!s&&r.a.createElement("p",null,"Find the boss."))),r.a.createElement("div",{className:"map"},s?r.a.createElement("div",{className:"game-over"},r.a.createElement("p",null,"Congratulations!"),r.a.createElement("p",null,"You left the dungeon!"),r.a.createElement("p",{className:"result"},"Your result: ",m," points.")):function(){for(var e=[],t=p;t<p+b;t++){var a=i[t].slice(E,E+O);e.push(a)}return console.log("visibleMap",e),console.log("currentOffsetY",p),console.log("currentOffsetX",E),e.map((function(e,t){return r.a.createElement("div",{className:t+p===0?"row-map first":t+p===S-1?"row-map last":"row-map",key:t+p},e.map((function(e,a){return r.a.createElement("div",{className:"square ".concat(e),key:"".concat(t+p).concat(a+E),style:{width:"".concat(B,"px"),height:"".concat(B,"px")}})})))}))}()),r.a.createElement("div",{className:"bottom-bar"},r.a.createElement("div",null,r.a.createElement("p",null,"Press 'Arrows' on the keyboard to move."),r.a.createElement("p",null,"Press 'Esc' to quit the game or click the button at the top right."))))},h=Object(o.b)((function(e){return{CERTIFICATES:E.CERTIFICATES,SKILLS:E.SKILLS,gameMap:e.game.map,currentCertificates:e.game.certificates,currentSkills:e.game.skills,isDefeatedBoss:e.game.isDefeatedBoss,level:e.game.level,points:e.game.points,currentOffsetX:e.game.currentOffsetX,currentOffsetY:e.game.currentOffsetY,playerX:e.game.playerX,playerY:e.game.playerY,difficulty:e.settings.difficulty,mapWidth:e.settings.mapWidth,mapHeight:e.settings.mapHeight,viewportWidth:e.settings.viewportWidth,viewportHeight:e.settings.viewportHeight}}),(function(e){return{moveLeft:function(t){return e(u["GAME/MOVE_LEFT"](t))},moveUp:function(t){return e(u["GAME/MOVE_UP"](t))},moveRight:function(t){return e(u["GAME/MOVE_RIGHT"](t))},moveDown:function(t){return e(u["GAME/MOVE_DOWN"](t))},changeOffsetX:function(t){return e(u["GAME/CHANGE_OFFSET_X"](t))},changeOffsetY:function(t){return e(u["GAME/CHANGE_OFFSET_Y"](t))},addCertificate:function(t){return e(u["GAME/ADD_CERTIFICATE"](t))},startLevel2:function(t){var a=t.map;return e(u["GAME/START_LEVEL2"]({map:a}))},addSkill:function(t){return e(u["GAME/ADD_SKILL"](t))},removeBossWalls:function(t){var a=t.map;return e(u["GAME/REMOVE_BOSS_WALLS"]({map:a}))},addPointsBoss:function(t){return e(u["GAME/ADD_POINTS_BOSS"](t))},quitGame:function(){return e(u["GAME/QUIT_GAME"]())},endGame:function(){return e(u["GAME/END_GAME"]())}}}))(d);var g=function(e){var t=e.difficultyOptions,a=e.difficulty,i=e.mapWidth,l=e.mapHeight,o=e.viewportWidth,s=e.viewportHeight,u=e.backToStartMenu,m=e.saveSettings,E=e.viewportWidthMax,p=e.viewportHeightMax,f=Object(n.useState)(a),d=Object(c.a)(f,2),h=d[0],g=d[1],S=Object(n.useState)(i),O=Object(c.a)(S,2),b=O[0],v=O[1],w=Object(n.useState)(l),A=Object(c.a)(w,2),M=A[0],T=A[1],y=Object(n.useState)(o),G=Object(c.a)(y,2),I=G[0],j=G[1],_=Object(n.useState)(s),N=Object(c.a)(_,2),H=N[0],W=N[1];function D(e,t){switch(e){case"Difficulty":g(+t.target.value);break;case"Map Width":v(+t.target.value);break;case"Map Height":T(+t.target.value);break;case"Viewport Width":j(+t.target.value);break;case"Viewport Height":W(+t.target.value)}}return r.a.createElement("div",{className:"settings"},r.a.createElement("div",{className:"top-bar-head"},r.a.createElement("h3",null,"Settings"),r.a.createElement("button",{className:"btn-back",type:"text",onClick:u},"Back")),r.a.createElement("form",{className:"settings-form",onSubmit:function(e){e.preventDefault(),console.log({difficultyInner:h,mapWidthInner:b,mapHeightInner:M,viewportWidthInner:I,viewportHeightInner:H}),m({difficultyInner:h,mapWidthInner:b,mapHeightInner:M,viewportWidthInner:I,viewportHeightInner:H})}},r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"difficulty"},"Difficulty:"),r.a.createElement("select",{id:"difficulty",value:h,onChange:D.bind(this,"Difficulty")},r.a.createElement("option",{value:t.easy},"Easy"),r.a.createElement("option",{value:t.medium},"Medium"),r.a.createElement("option",{value:t.hard},"Hard"))),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"map-width"},"Map Width ",r.a.createElement("small",null,"(20 - 200)"),":"),r.a.createElement("input",{id:"map-width",type:"number",value:b,min:"20",max:"200",step:"5",onChange:D.bind(this,"Map Width")})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"map-height"},"Map Height ",r.a.createElement("small",null,"(50 - 500)"),":"),r.a.createElement("input",{id:"map-height",type:"number",value:M,min:"50",max:"500",step:"5",onChange:D.bind(this,"Map Height")})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"viewport-width"},"Viewport Width ",r.a.createElement("small",null,"(10 - ",i<=o?i:E,")"),":"),r.a.createElement("input",{id:"viewport-width",type:"number",value:I,min:"10",max:i<=o?i:E,step:"1",onChange:D.bind(this,"Viewport Width")})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"viewport-height"},"Viewport Height ",r.a.createElement("small",null,"(10 - ",p,")"),":"),r.a.createElement("input",{id:"viewport-height",type:"number",value:H,min:"10",max:p,step:"1",onChange:D.bind(this,"Viewport Height")})),r.a.createElement("button",{type:"submit",className:"btn-save"},"Save")))},S=Object(o.b)((function(e){return{difficultyOptions:E.DIFFICULTY,difficulty:e.settings.difficulty,mapWidth:e.settings.mapWidth,mapHeight:e.settings.mapHeight,viewportWidth:e.settings.viewportWidth,viewportHeight:e.settings.viewportHeight}}),(function(e){return{backToStartMenu:function(){return e(m["SETTINGS/HIDE_SETTINGS"]())},saveSettings:function(t){var a=t.difficultyInner,n=t.mapWidthInner,r=t.mapHeightInner,i=t.viewportWidthInner,l=t.viewportHeightInner;return e(m["SETTINGS/SAVE_SETTINGS"]({difficultyInner:a,mapWidthInner:n,mapHeightInner:r,viewportWidthInner:i,viewportHeightInner:l}))}}}))(g);var O=function(e){var t=e.isSettingsShow,a=e.gameOn,i=e.mapWidth,l=e.mapHeight,o=Object(n.useState)(0),s=Object(c.a)(o,2),u=s[0],m=s[1],E=Object(n.useState)(0),p=Object(c.a)(E,2),d=p[0],g=p[1],O=Object(n.useState)(0),b=Object(c.a)(O,2),v=b[0],w=b[1],A=Object(n.useState)(0),M=Object(c.a)(A,2),T=M[0],y=M[1];function G(e,t,a){var n=Math.floor(l/t),r=0,o=0;for(l%t!==0&&(r=1,o=Math.ceil(l%t)-1),console.log("itemBalance",o),console.log("itemsInterval",n);r<l;){var c=I(r,r+n-1),s=I(0,i-1);console.log("itemVar",r),"empty"!==e[c][s]||0!==s&&s!==i-1&&0!==c&&c!==l-1&&u(c,s-1)&&u(c,s+1)&&u(c-1,s)&&u(c+1,s)||0===c&&0===s&&u(c,s+1)&&u(c+1,s)&&u(c,i-1)||0===c&&s===i-1&&u(c,s-1)&&u(c+1,s)&&u(c,0)||c===l-1&&s===i-1&&u(c,s-1)&&u(c-1,s)&&u(c,0)||c===l-1&&0===s&&u(c,s+1)&&u(c-1,s)&&u(c,i-1)||0===c&&0!==s&&s!==i-1&&u(c,s-1)&&u(c,s+1)&&u(c+1,s)||c===l-1&&0!==s&&s!==i-1&&u(c,s-1)&&u(c,s+1)&&u(c-1,s)||0===s&&0!==c&&c!==l-1&&u(c,s+1)&&u(c+1,s)&&u(c-1,s)||s===i-1&&0!==c&&c!==l-1&&u(c,s-1)&&u(c+1,s)&&u(c-1,s)||(e[c][s]=a,o>0?(r+=n+1,o--):0===o&&(r+=n))}function u(t,a){return"wall"===e[t][a]||"boss-wall"===e[t][a]}}function I(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}return Object(n.useEffect)((function(){m(document.documentElement.clientWidth),g(document.documentElement.clientHeight),w(10*Math.floor(9.1*u/2500)),y(10*Math.floor(5.1*d/2500))}),[]),r.a.createElement("div",{style:{height:d+"px"}},!t&&!a&&r.a.createElement(f,{generateItems:G,getRandomNumber:I}),a&&r.a.createElement(h,{windowWidth:u,windowHeight:d,generateItems:G}),t&&r.a.createElement(S,{viewportWidthMax:v,viewportHeightMax:T}))},b=Object(o.b)((function(e){return{isSettingsShow:e.settings.isSettingsShow,gameOn:e.game.gameOn,mapWidth:e.settings.mapWidth,mapHeight:e.settings.mapHeight}}),(function(e){return{}}))(O);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var v,w,A=a(6),M=a(1),T=a(2),y=a.n(T),G=a(30),I=Object(G.a)((v={},Object(M.a)(v,m["SETTINGS/SHOW_SETTINGS"],(function(e,t){return y()(e,{$merge:{isSettingsShow:!0}})})),Object(M.a)(v,m["SETTINGS/HIDE_SETTINGS"],(function(e,t){return y()(e,{$merge:{isSettingsShow:!1}})})),Object(M.a)(v,m["SETTINGS/SAVE_SETTINGS"],(function(e,t){return y()(e,{$merge:{difficulty:t.payload.difficultyInner,mapWidth:t.payload.mapWidthInner,mapHeight:t.payload.mapHeightInner,viewportWidth:t.payload.viewportWidthInner,viewportHeight:t.payload.viewportHeightInner}})})),v),{isSettingsShow:!1,difficulty:20,mapWidth:20,mapHeight:100,viewportWidth:20,viewportHeight:10}),j={gameOn:!1,map:[],certificates:0,skills:0,isDefeatedBoss:!1,level:0,points:0,currentOffsetX:0,currentOffsetY:0,playerX:0,playerY:0},_=Object(G.a)((w={},Object(M.a)(w,u["GAME/START_GAME"],(function(e,t){return console.log(t.payload),y()(e,{$merge:{gameOn:!0,map:t.payload.map,level:1,playerX:t.payload.playerX}})})),Object(M.a)(w,u["GAME/MOVE_LEFT"],(function(e,t){var a;return y()(e,{map:Object(M.a)({},e.playerY,(a={},Object(M.a)(a,e.playerX,{$set:"empty"}),Object(M.a)(a,t.payload,{$set:"player"}),a)),playerX:{$set:t.payload}})})),Object(M.a)(w,u["GAME/MOVE_UP"],(function(e,t){var a;return y()(e,{map:(a={},Object(M.a)(a,e.playerY,Object(M.a)({},e.playerX,{$set:"empty"})),Object(M.a)(a,t.payload,Object(M.a)({},e.playerX,{$set:"player"})),a),playerY:{$set:t.payload}})})),Object(M.a)(w,u["GAME/MOVE_RIGHT"],(function(e,t){var a;return y()(e,{map:Object(M.a)({},e.playerY,(a={},Object(M.a)(a,e.playerX,{$set:"empty"}),Object(M.a)(a,t.payload,{$set:"player"}),a)),playerX:{$set:t.payload}})})),Object(M.a)(w,u["GAME/MOVE_DOWN"],(function(e,t){var a;return y()(e,{map:(a={},Object(M.a)(a,e.playerY,Object(M.a)({},e.playerX,{$set:"empty"})),Object(M.a)(a,t.payload,Object(M.a)({},e.playerX,{$set:"player"})),a),playerY:{$set:t.payload}})})),Object(M.a)(w,u["GAME/CHANGE_OFFSET_X"],(function(e,t){return y()(e,{$merge:{currentOffsetX:t.payload}})})),Object(M.a)(w,u["GAME/CHANGE_OFFSET_Y"],(function(e,t){return y()(e,{$merge:{currentOffsetY:t.payload}})})),Object(M.a)(w,u["GAME/ADD_CERTIFICATE"],(function(e,t){return y()(e,{$merge:{certificates:e.certificates+1,points:e.points+t.payload}})})),Object(M.a)(w,u["GAME/START_LEVEL2"],(function(e,t){return y()(e,{$merge:{map:t.payload.map,level:2}})})),Object(M.a)(w,u["GAME/ADD_SKILL"],(function(e,t){return y()(e,{$merge:{skills:e.skills+1,points:e.points+t.payload}})})),Object(M.a)(w,u["GAME/REMOVE_BOSS_WALLS"],(function(e,t){return y()(e,{$merge:{map:t.payload.map}})})),Object(M.a)(w,u["GAME/ADD_POINTS_BOSS"],(function(e,t){return y()(e,{$merge:{points:e.points+t.payload}})})),Object(M.a)(w,u["GAME/QUIT_GAME"],(function(e,t){return y()(e,{$merge:{gameOn:j.gameOn,map:j.map,certificates:j.certificates,skills:j.skills,isDefeatedBoss:j.isDefeatedBoss,level:j.level,points:j.points,currentOffsetX:j.currentOffsetX,currentOffsetY:j.currentOffsetY,playerX:j.playerX,playerY:j.playerY}})})),Object(M.a)(w,u["GAME/END_GAME"],(function(e,t){return y()(e,{$merge:{isDefeatedBoss:!0}})})),w),j),N=Object(A.c)({settings:I,game:_}),H=a(17),W=a.n(H),D=Object(A.d)(N,Object(A.a)(W.a));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(o.a,{store:D},r.a.createElement(b,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[18,1,2]]]);
//# sourceMappingURL=main.b5b96b0f.chunk.js.map